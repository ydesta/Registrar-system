<h3 class="h-tag">Registered Student Per Batch</h3>
<nz-divider></nz-divider>
<nz-card>
    <form nz-form [formGroup]="formRegisteredStudentPerBatch">
        <div nz-row [nzGutter]="24">
            <div nz-col nzSpan="11">

                <nz-form-item>
                    <nz-form-label [nzSpan]="5" nzRequired>Term Year</nz-form-label>
                    <nz-form-control nzValidatingTip="Validating...">
                        <nz-select formControlName="termYear" nzPlaceHolder="Select Term Year" nzShowSearch>
                            <nz-option *ngFor="let item of yearList" [nzValue]="item" [nzLabel]="item"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
                <nz-form-item>
                    <nz-form-label [nzSpan]="5" nzRequired>Course</nz-form-label>
                    <nz-form-control nzValidatingTip="Validating...">
                        <nz-select formControlName="courseId" nzPlaceHolder="Select Course" nzShowSearch>
                            <nz-option *ngFor="let item of courses" [nzValue]="item.id"
                                [nzLabel]="item.courseTitle"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col nzSpan="11">

                <nz-form-item>
                    <nz-form-label nzRequired>Academic Term</nz-form-label>
                    <nz-form-control>
                        <nz-select formControlName="termId" nzPlaceHolder="Select Academic Term" nzShowSearch="true"
                            nzAllowClear="true">
                            <nz-option *ngFor="let item of listOfTermNumber" [nzValue]="item.Id"
                                [nzLabel]="item.Description"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
                <nz-form-item>
                    <nz-form-label nzRequired>Batch Code</nz-form-label>
                    <nz-form-control>
                        <nz-select formControlName="batchCode" nzPlaceHolder="Select Batch Code" nzShowSearch="true"
                            nzAllowClear="true">
                            <nz-option *ngFor="let item of listOfBatch" [nzValue]="item.batchCode"
                                [nzLabel]="item.batchCode"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
                <nz-form-item>
                    <nz-form-control [nzOffset]="20" [nzSpan]="15">
                        <button nz-button nzType="primary" class="submit" (click)="getRegisteredStudentPerBatch()"
                            [disabled]="!formRegisteredStudentPerBatch.valid">Search</button>
                    </nz-form-control>
                </nz-form-item>
            </div>
        </div>
    </form>
</nz-card>
<nz-card style="margin-top: 50px;" *ngIf="total > 0">
    <div class="header-section">
        <h2>Registered Students per Course</h2>
        <div class="action-buttons">
          <button nz-button nzType="primary" (click)="exportToExcel()">
            <span nz-icon nzType="file-excel" nzTheme="outline"></span>
            Export To Excel
          </button>
          <button nz-button nzType="primary" (click)="exportToPdf()" >
            <span nz-icon nzType="printer" nzTheme="outline"></span>
            Export To PDF 
          </button>
        </div>
      </div>
    <div id="print-section">
        <nz-table #basicTable [nzData]="paginatedRegisteredStudent" nzBordered [nzPageSize]="pageSize"
            [nzPageSizeOptions]="pageSizeOption" [nzShowSizeChanger]="true" [nzTotal]="total" [nzPageIndex]="pageIndex"
            (nzPageIndexChange)="onPageIndexChange($event)" (nzPageSizeChange)="onPageSizeChange($event)"
            [nzFrontPagination]="false" [nzShowTotal]="rangeTemplate" [nzLoading]="isLoading" [nzNoResult]="emptyTpl">
            <ng-template #rangeTemplate let-range="range" let-total>
                {{ range[0] }}-{{ range[1] }} of {{ total }} items
            </ng-template>
            <thead>
                <tr>
                    <th>Serial No.</th>
                    <th>Student Code</th>
                    <th>Full Name</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let reg of paginatedRegisteredStudent">
                    <td>{{ reg.serialNo }}</td>
                    <td>{{ reg.studentCode }}</td>
                    <td>{{ reg.fullName }}</td>
                </tr>
            </tbody>
            <ng-template #emptyTpl>
                <div class="no-data">
                    <span nz-icon nzType="book" nzTheme="outline"></span>
                    <p>No Academic term activity records available</p>
                </div>
            </ng-template>
        </nz-table>
    </div>
</nz-card>