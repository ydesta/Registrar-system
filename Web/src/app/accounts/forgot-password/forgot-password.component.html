<app-auth-header></app-auth-header>

<div class="forgot-password-container">
  <div class="forgot-password-card">
    <div class="logo-section">
      <img src="../../../assets/images/log.png" alt="HiLCoE Logo" class="logo" (click)="goToHome()" style="cursor: pointer;">
      <h2>Forgot Password</h2>
      <p>Enter your email address to reset your password</p>
    </div>

    <!-- Email Sent Success State -->
    <div *ngIf="emailSent" class="success-state">
      <div class="success-icon">
        <i nz-icon nzType="info-circle" nzTheme="twotone" nzTwotoneColor="#1890ff"></i>
      </div>
      <h3>Request Submitted</h3>
      <p>We've processed your request for:</p>
      <div class="email-display">{{ emailAddress }}</div>
      <p class="instructions">
        <strong>If an account with this email address exists</strong>, you will receive password reset instructions. 
        Please check your email inbox and spam folder. If you don't receive an email within a few minutes, 
        the email address may not be registered with our system.
      </p>
      
      <div class="redirect-info" *ngIf="redirectCountdown > 0">
        <p>
          <i nz-icon nzType="clock-circle" nzTheme="outline"></i>
          Redirecting to login page in {{ redirectCountdown }} second{{ redirectCountdown !== 1 ? 's' : '' }}...
        </p>
        <button 
          nz-button 
          class="skip-wait-button" 
          [nzType]="'primary'"
          [nzSize]="'large'"
          (click)="goToLogin()">
          <i nz-icon nzType="login" nzTheme="outline"></i>
          Go to Login Now
        </button>
      </div>
      
      <div class="success-actions">
        <button 
          nz-button 
          class="resend-button" 
          [nzType]="'default'"
          (click)="resendEmail()">
          Resend Email
        </button>
        <button 
          nz-button 
          class="back-to-login-button" 
          [nzType]="'primary'"
          (click)="goToLogin()">
          Go to Login
        </button>
      </div>
    </div>

    <!-- Forgot Password Form -->
    <form *ngIf="!emailSent" nz-form [formGroup]="forgotPasswordForm" class="forgot-password-form" (ngSubmit)="submitForm()">
      <nz-form-item>
        <nz-form-control nzErrorTip="Please input a valid email address!">
          <nz-input-group nzPrefixIcon="mail">
            <input 
              type="email" 
              nz-input 
              formControlName="email" 
              placeholder="Enter your email address" />
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>

      <div class="form-info">
        <p>
          <i nz-icon nzType="info-circle" nzTheme="outline"></i>
          Enter the email address associated with your account. If the email is registered, you'll receive password reset instructions.
        </p>
      </div>

      <div class="forgot-password-actions">
        <button 
          nz-button 
          class="submit-button" 
          [nzType]="'primary'" 
          [nzLoading]="isLoading"
          [disabled]="!forgotPasswordForm.valid || isLoading">
          {{ isLoading ? 'Sending...' : 'Send Reset Link' }}
        </button>
      </div>
    </form>

    <!-- Navigation Links -->
    <div class="navigation-links">
      <div class="link-group">
        <span>Remember your password? </span>
        <a (click)="goToLogin()">Sign in</a>
      </div>
      <div class="link-group">
        <span>Don't have an account? </span>
        <a (click)="goToRegister()">Sign up</a>
      </div>
    </div>
  </div>
</div> 