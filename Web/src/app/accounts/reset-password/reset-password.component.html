<app-auth-header></app-auth-header>

<div class="reset-password-container">
  <div class="reset-password-card">
    <div class="logo-section">
      <img src="../../../assets/images/logo.png" alt="HiLCoE Logo" class="logo" (click)="goToHome()" style="cursor: pointer;">
      <h2>Reset Password</h2>
      <p>Enter your new password</p>
    </div>

    <!-- Password Reset Success State -->
    <div *ngIf="passwordReset" class="success-state">
      <div class="success-icon">
        <i nz-icon nzType="check-circle" nzTheme="twotone" nzTwotoneColor="#52c41a"></i>
      </div>
      <h3>Password Reset Successful</h3>
      <p>Your password has been reset successfully. You can now login with your new password.</p>
      
      <div class="success-actions">
        <button 
          nz-button 
          class="login-button" 
          [nzType]="'primary'"
          (click)="goToLogin()">
          Go to Login
        </button>
      </div>
    </div>

    <!-- Reset Password Form -->
    <form *ngIf="!passwordReset" nz-form [formGroup]="resetPasswordForm" class="reset-password-form" (ngSubmit)="submitForm()">
      <nz-form-item>
        <nz-form-control nzErrorTip="Password must be at least 8 characters with uppercase, lowercase, number, and special character!">
          <nz-input-group nzPrefixIcon="lock" [nzSuffix]="passwordSuffix">
            <input 
              [type]="passwordVisible ? 'text' : 'password'" 
              nz-input 
              formControlName="newPassword" 
              placeholder="New Password" />
          </nz-input-group>
          <ng-template #passwordSuffix>
            <i 
              nz-icon 
              [nzType]="passwordVisible ? 'visibility-off' : 'visibility'" 
              nzTheme="outline"
              (click)="togglePasswordVisibility()"
              class="password-toggle">
            </i>
          </ng-template>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control nzErrorTip="Passwords do not match!">
          <nz-input-group nzPrefixIcon="lock" [nzSuffix]="confirmPasswordSuffix">
            <input 
              [type]="confirmPasswordVisible ? 'text' : 'password'" 
              nz-input 
              formControlName="confirmPassword" 
              placeholder="Confirm New Password" />
          </nz-input-group>
          <ng-template #confirmPasswordSuffix>
            <i 
              nz-icon 
              [nzType]="confirmPasswordVisible ? 'visibility-off' : 'visibility'" 
              nzTheme="outline"
              (click)="toggleConfirmPasswordVisibility()"
              class="password-toggle">
            </i>
          </ng-template>
        </nz-form-control>
      </nz-form-item>

      <div class="form-info">
        <p>
          <i nz-icon nzType="info-circle" nzTheme="outline"></i>
          Your password must be at least 8 characters long and contain uppercase, lowercase, number, and special character.
        </p>
      </div>

      <div class="reset-password-actions">
        <button 
          nz-button 
          class="submit-button" 
          [nzType]="'primary'" 
          [nzLoading]="isLoading"
          [disabled]="!resetPasswordForm.valid || isLoading">
          {{ isLoading ? 'Resetting...' : 'Reset Password' }}
        </button>
      </div>
    </form>

    <!-- Navigation Links -->
    <div class="navigation-links">
      <div class="link-group">
        <span>Remember your password? </span>
        <a (click)="goToLogin()">Sign in</a>
      </div>
      <div class="link-group">
        <span>Need to request a new reset link? </span>
        <a (click)="goToForgotPassword()">Forgot Password</a>
      </div>
    </div>
  </div>
</div> 