<div class="modal-content">
  <!-- Student Information Card -->
  <nz-card *ngIf="studentInfo" class="info-card" nzTitle="Student Information">
    <div class="student-info-container">
      <div class="info-row">
        <div class="info-item">
          <span class="label">Student Code:</span>
          <span class="value">{{ getStudentCode() }}</span>
        </div>
        <div class="info-item">
          <span class="label">Name:</span>
          <span class="value">{{ getStudentDisplayName() }}</span>
        </div>
      </div>
      <div class="info-row" *ngIf="batchCode">
        <div class="info-item">
          <span class="label">Batch:</span>
          <span class="value">{{ batchCode }}</span>
        </div>
        <div class="info-item">
          <span class="label">Academic Term:</span>
          <span class="value">{{ academicTerm }}</span>
        </div>
        <div class="info-item">
          <span class="label">Year:</span>
          <span class="value">{{ year }}</span>
        </div>
      </div>
    </div>
  </nz-card>

  <!-- Section Type Display -->
  <nz-card class="info-card" nzTitle="Section Information">
    <div class="student-info-container">
      <div class="info-row">
        <div class="info-item">
          <span class="label">Section Type:</span>
          <span class="value">{{ sectionType === 0 ? 'Regular' : 'Lab' }}</span>
        </div>
      </div>
    </div>
  </nz-card>

  <!-- Loading State -->
  <nz-card *ngIf="loadingStudent || loadingCourses" class="loading-card">
    <div class="loading-container">
      <nz-spin nzSimple [nzSize]="'large'">
        <div class="loading-content">
          <h3>{{ loadingStudent ? 'Loading student information...' : 'Loading courses...' }}</h3>
        </div>
      </nz-spin>
    </div>
  </nz-card>

  <!-- Course Assignment Section -->
  <nz-card *ngIf="!loadingStudent && !loadingCourses && courses.length > 0" class="content-card"
    nzTitle="Course Section Assignments">
    <div class="assignment-summary">
      <p class="summary-text">
        <i nz-icon nzType="info-circle" nzTheme="outline"></i>
        Please select sections for all {{ getTotalCourses() }} course(s). ({{ getAssignedCoursesCount() }} of {{
        getTotalCourses() }} assigned)
      </p>
    </div>

    <form [formGroup]="searchForm">
      <nz-table #courseTable [nzData]="courses" [nzFrontPagination]="false" [nzShowSizeChanger]="false"
        [nzLoading]="loading" nzSize="middle">
        <thead>
          <tr>
            <th nzWidth="12%">Course Code</th>
            <th nzWidth="28%">Course Title</th>
            <th nzWidth="10%">Batch</th>
            <th nzWidth="10%">Status</th>
            <th nzWidth="30%">Section *</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let course of courses; let i = index" [formArrayName]="'courseAssignments'">
            <td>{{ course.courseCode }}</td>
            <td>{{ course.courseTitle }}</td>
            <td>{{ course.batchCode || '-' }}</td>
            <td>
              <nz-tag [nzColor]="getStatusColor(course.registrationStatus)">
                {{ course.registrationStatus || '-' }}
              </nz-tag>
            </td>

              <td>
                <ng-container [formGroupName]="i">
                 <nz-select 
                   formControlName="sectionId" 
                   nzPlaceHolder="Select section *" 
                   [nzLoading]="loadingSections"
                   nzShowSearch
                   class="section-select">
                   <nz-option *ngFor="let section of allSections" 
                             [nzValue]="section.id" 
                             [nzLabel]="section.sectionName">
                     {{ section.sectionName }}
                   </nz-option>
                 </nz-select>
               </ng-container>
             </td>
          </tr>
        </tbody>
      </nz-table>
    </form>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button nz-button nzType="default" nzSize="large" (click)="onCancel()">
        <i nz-icon nzType="close" nzTheme="outline"></i>
        Cancel
      </button>
      <button nz-button nzType="primary" nzSize="large" (click)="onSubmit()" [nzLoading]="loading">
        <i nz-icon nzType="check" nzTheme="outline"></i>
        Submit Assignments
      </button>
    </div>
  </nz-card>

  <!-- No Courses Available -->
  <nz-card *ngIf="!loadingStudent && !loadingCourses && courses.length === 0" class="content-card">
    <div class="empty-state">
      <nz-empty [nzNotFoundContent]="content" [nzNotFoundImage]="'simple'">
        <ng-template #content>
          <p>No courses available for assignment</p>
          <button nz-button nzType="default" (click)="onCancel()">
            <i nz-icon nzType="arrow-left" nzTheme="outline"></i>
            Back to Unassigned Students
          </button>
        </ng-template>
      </nz-empty>
    </div>
  </nz-card>

  <!-- Success Summary -->
  <nz-card *ngIf="showSummary" class="success-card" nzTitle="Assignment Successful">
    <div class="success-content">
      <i nz-icon nzType="check-circle" nzTheme="fill" class="success-icon"></i>
      <h3>Student assigned to sections successfully!</h3>
      <p>Redirecting to unassigned students page...</p>
    </div>
  </nz-card>
</div>