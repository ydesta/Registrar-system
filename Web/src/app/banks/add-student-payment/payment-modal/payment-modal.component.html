<form nz-form [formGroup]="bankTransactionForm">
  <div class="form-section-header">Payment Details</div>
  
  <nz-card>
    <div nz-row [nzGutter]="24">
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label [nzSpan]="24" nzRequired class="required-field">From Bank</nz-form-label>
          <nz-form-control>
            <nz-select formControlName="fromBank" nzPlaceHolder="Select Bank" nzShowSearch
              [class.error]="bankTransactionForm.controls['fromBank'].invalid && (bankTransactionForm.controls['fromBank'].dirty || bankTransactionForm.controls['fromBank'].touched)">
              <nz-option *ngFor="let item of banks" [nzValue]="item.id" [nzLabel]="item.bankName"></nz-option>
            </nz-select>
            <div nz-form-explain
              *ngIf="bankTransactionForm.controls['fromBank'].invalid && (bankTransactionForm.controls['fromBank'].dirty || bankTransactionForm.controls['fromBank'].touched)">
              <span class="error-message">From Bank is required.</span>
            </div>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="24" nzRequired class="required-field">To Bank</nz-form-label>
          <nz-form-control>
            <nz-select formControlName="toBank" nzPlaceHolder="Select to bank" nzShowSearch
              [class.error]="bankTransactionForm.controls['toBank'].invalid && (bankTransactionForm.controls['toBank'].dirty || bankTransactionForm.controls['toBank'].touched)">
              <nz-option *ngFor="let item of listOfBankTo" [nzValue]="item.Id"
                [nzLabel]="item.Description"></nz-option>
            </nz-select>
            <div nz-form-explain
              *ngIf="bankTransactionForm.controls['toBank'].invalid && (bankTransactionForm.controls['toBank'].dirty || bankTransactionForm.controls['toBank'].touched)">
              <span class="error-message">To Bank is required.</span>
            </div>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="24">Remark</nz-form-label>
          <nz-form-control>
            <nz-textarea-count [nzMaxCharacterCount]="250">
              <textarea rows="4" formControlName="remark" nz-input placeholder="Enter any additional remarks here..."></textarea>
            </nz-textarea-count>
          </nz-form-control>
        </nz-form-item>
      </div>

      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label [nzSpan]="24" nzRequired class="required-field">Bank Transaction No.</nz-form-label>
          <nz-form-control>
            <input nz-input formControlName="bankTransactionID" placeholder="Enter transaction ID"
              [class.error]="bankTransactionForm.controls['bankTransactionID'].invalid && (bankTransactionForm.controls['bankTransactionID'].dirty || bankTransactionForm.controls['bankTransactionID'].touched)" />
            <div nz-form-explain
              *ngIf="bankTransactionForm.controls['bankTransactionID'].invalid && (bankTransactionForm.controls['bankTransactionID'].dirty || bankTransactionForm.controls['bankTransactionID'].touched)">
              <span class="error-message">Bank Transaction ID is required.</span>
            </div>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="24">Total Amount</nz-form-label>
          <nz-form-control>
            <input nz-input [value]="totalAmount | currency:'ETB '"  class="readonly-input" />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="24" nzRequired class="required-field">Transaction Date</nz-form-label>
          <nz-form-control>
            <nz-date-picker class="ant-calendar-picker" formControlName="transactionDate"
              [class.error]="bankTransactionForm.controls['transactionDate'].invalid && (bankTransactionForm.controls['transactionDate'].dirty || bankTransactionForm.controls['transactionDate'].touched)"></nz-date-picker>
            <div nz-form-explain
              *ngIf="bankTransactionForm.controls['transactionDate'].invalid && (bankTransactionForm.controls['transactionDate'].dirty || bankTransactionForm.controls['transactionDate'].touched)">
              <span class="error-message">Transaction Date is required.</span>
            </div>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSpan]="24" nzRequired class="required-field">Receipt Attachment</nz-form-label>
          <nz-form-control [nzErrorTip]="'Attachment is required or invalid file type'" [nzValidateStatus]="bankTransactionForm.controls['attachment']">
            <input type="file" (change)="onFileSelected($event)" accept="image/*,application/pdf" />
            <div *ngIf="bankTransactionForm.controls['attachment'].hasError('invalidType')" class="error-message">
              Only images (JPEG, PNG) and PDFs are allowed.
            </div>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>
  </nz-card>

  <div class="modal-footer">
    <button nz-button nzType="default" (click)="closeModal()">Cancel</button>
    <button nz-button nzType="primary" (click)="submitForm()" [disabled]="bankTransactionForm.invalid">Submit</button>
  </div>
</form> 