<div class="pending-payments-container">
  <div class="header-section">
    <div class="title-section">
      <div class="title-with-icon">
        <span nz-icon nzType="wallet" nzTheme="outline" class="title-icon"></span>
        <h3>Pending Payments</h3>
      </div>
      <div class="subtitle">View and manage your pending course payments</div>
    </div>
    <div class="total-amount" *ngIf="listOfPendingPayments.length > 0">
      <div class="amount-card">
        <div class="amount-header">
          <span nz-icon nzType="dollar-circle" nzTheme="outline" class="amount-icon"></span>
          <div class="label">Total Pending Amount</div>
        </div>
        <div class="amount">{{ getTotalAmount() | currency:'ETB ' }}</div>
        <div class="amount-subtitle">{{ listOfPendingPayments.length }} payment{{ listOfPendingPayments.length > 1 ? 's' : '' }}</div>
      </div>
    </div>
  </div>

  <app-payment-instructions></app-payment-instructions>

  <div class="table-section">
    <!-- Show table only when there's data or loading -->
    <nz-table 
      *ngIf="listOfPendingPayments.length > 0 || isLoading"
      #basicTable 
      [nzData]="listOfPendingPayments" 
      [nzShowPagination]="false"
      [nzLoading]="isLoading"
      [nzShowSizeChanger]="true">
      <thead>
        <tr>
          <th>Batch Code</th>
          <th>Request Type</th>
          <th>Total Courses</th>
          <th>Registered On</th>
          <th>Status</th>
          <th>Amount</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of basicTable.data; trackBy: trackByPaymentId">
          <td>{{ data.batchCode }}</td>
          <td>{{ data.requestType }}</td>
          <td>{{ data.numberOfRegistered }}</td>
          <td class="date-cell">{{ data.registeredOn | date:'mediumDate' }}</td>
          <td>
            <span class="status-badge" [ngClass]="data.status.toLowerCase()">{{ data.status }}</span>
          </td>
          <td class="amount-cell">{{ data.totalPayment | currency:'ETB ' }}</td>
          <td class="action-button">
            <button 
              nz-button 
              nzType="primary" 
              (click)="goToPaymentPage(data)" 
              [disabled]="data.status === 'Paid'"
              [nzLoading]="data.isProcessing">
              Payment 
            </button>
          </td>
        </tr>
      </tbody>
    </nz-table>

    <!-- Show custom empty state only when not loading and no data -->
    <div *ngIf="!isLoading && listOfPendingPayments.length === 0" class="empty-state">
      <div class="empty-content">
        <div class="empty-icon-wrapper">
          <span nz-icon nzType="wallet" nzTheme="outline" class="empty-icon"></span>
          <div class="empty-icon-bg"></div>
        </div>
        <div class="empty-text">No Pending Payments</div>
        <div class="empty-subtitle">You don't have any pending course payments at the moment. All your payments are up to date!</div>
        <div class="empty-actions">
          <button nz-button nzType="primary" nzGhost (click)="getStudentCoursePendingPayment()">
            <span nz-icon nzType="reload"></span>
            Refresh
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
  