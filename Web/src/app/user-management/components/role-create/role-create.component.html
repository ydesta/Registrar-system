<form nz-form [formGroup]="roleForm" (ngSubmit)="onSubmit()">
  <nz-form-item>
    <nz-form-label [nzSpan]="6" nzRequired>Role Name</nz-form-label>
    <nz-form-control [nzSpan]="18" nzErrorTip="Please enter a valid role name">
      <input nz-input formControlName="name" placeholder="Enter role name" />
    </nz-form-control>
  </nz-form-item>
  
  <nz-form-item>
    <nz-form-label [nzSpan]="6">Description</nz-form-label>
    <nz-form-control [nzSpan]="18">
      <textarea 
        nz-input 
        formControlName="description" 
        placeholder="Enter role description"
        [nzAutosize]="{ minRows: 3, maxRows: 5 }">
      </textarea>
    </nz-form-control>
  </nz-form-item>
  
  <nz-form-item>
    <nz-form-label [nzSpan]="6">Status</nz-form-label>
    <nz-form-control [nzSpan]="18">
      <nz-switch formControlName="isActive"></nz-switch>
      <span style="margin-left: 8px;">{{ roleForm.get('isActive')?.value ? 'Active' : 'Inactive' }}</span>
    </nz-form-control>
  </nz-form-item>

  <h3 style="margin-top: 24px;">Select Permissions</h3>
  <nz-collapse>
    <nz-collapse-panel
      *ngFor="let category of getPermissionCategories(); trackBy: trackByCategory"
      [nzHeader]="category + ' (' + getPermissionsByCategory(category).length + ')'"
      nzForceRender
    >
      <!-- <div class="category-actions">
        <button nz-button nzSize="small" (click)="selectAllInCategory(category)" [disabled]="areAllSelectedInCategory(category)">Select All</button>
        <button nz-button nzSize="small" (click)="clearAllInCategory(category)" [disabled]="!isAnySelectedInCategory(category)">Clear All</button>
      </div> -->
      <div class="permission-toggles">
        <div
          *ngFor="let permission of getPermissionsByCategory(category)"
          class="permission-toggle-item"
        >
          <nz-switch
            [ngModel]="isPermissionSelected(permission.id)"
            (ngModelChange)="setPermissionSelected(permission.id, $event)"
            [ngModelOptions]="{standalone: true}">
          </nz-switch>
          <div class="permission-info">
            <span class="permission-label">{{ permission.name }}</span>
            <span
              class="permission-description"
              *ngIf="permission.description"
              [nz-tooltip]="permission.description"
              >{{ permission.description }}</span
            >
          </div>
        </div>
      </div>
    </nz-collapse-panel>
  </nz-collapse>

  <div class="modal-footer">
    <button 
      nz-button 
      nzType="default" 
      (click)="onCancel()">
      Cancel
    </button>
    <button 
      nz-button 
      nzType="primary" 
      [nzLoading]="submitting"
      [disabled]="!roleForm.valid"
      type="submit">
      Create Role
    </button>
  </div>
</form> 